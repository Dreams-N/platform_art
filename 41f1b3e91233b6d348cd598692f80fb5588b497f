Revision: 41f1b3e91233b6d348cd598692f80fb5588b497f
Patch-set: 2
File: compiler/dex/quick/arm/int_arm.cc

221:0-222:44
Thu Jul 17 09:56:51 2014 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: b9f87cd3_432c6681
Bytes: 84
Move these DCHECKs to the beginning of the function to cover the special case above.

File: compiler/dex/quick/arm64/int_arm64.cc

90:29-90:37
Thu Jul 17 09:56:51 2014 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: d9fb70cc_043676d1
Bytes: 8
int32_t?

156
Thu Jul 17 09:56:51 2014 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: b9f87cd3_635642ea
Bytes: 620
This has a dependency on the previous load insn. It should not be used if the false_val is itself inexpensive for the LoadConstantNoClobber() below.

When we're doing this, we should also add another condition to the NegateComparison()+swap() at the beginning to prefer an inexpensive constant in true_val if all the previous conditions fail. That helps when we enter the function with true_val = 0x1001, false_val = 0x0FFF, for example.

However, I don't think these cases will be very common. The whole delta encoding should probably be dropped because the logic is too complicated to be worth it for such a rare case.

File: compiler/dex/quick/x86/int_x86.cc

223
Thu Jul 17 09:56:51 2014 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: b9f87cd3_03fb0e8c
Bytes: 210
MOVZX? (Otherwise we retain 24 bits.)

Or just delay the refactoring for the x86 GenSelect() until you actually provide the preloaded value. Then the MOVZX will be unnecessary if the high 24 bits are already 0.

223
Thu Jul 17 10:15:10 2014 +0000
Author: Serguei I Katkov <1040038@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: b9f87cd3_03fb0e8c
UUID: d9fb70cc_44b46eba
Bytes: 163
rs_dest is set to zero two instruction above so no need to do movzx here, however zeroing rs_dest is not safe itself if it is equal to one of the source registers.

