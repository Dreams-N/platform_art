Revision: 5b82d339955d1a0dc23eeb8d2d5659459ff987ba
Patch-set: 3
File: compiler/optimizing/inliner.cc

560:8-560:36
Thu Feb 18 16:04:52 2016 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e200b9f1_1ba51bcc
Bytes: 93
I'm quite curious. What's the practical impact of this? How much code is structured that way?

560:8-560:36
Thu Feb 18 16:33:10 2016 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e200b9f1_1ba51bcc
UUID: 0234edda_cca6cfd6
Bytes: 48
Structured which way? Looking at whether we JIT?

560:8-560:36
Thu Feb 18 16:45:40 2016 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 0234edda_cca6cfd6
UUID: 4225059f_3607d86b
Bytes: 467
I mean: the code that's trying to be inlined has not been touched before. Example

 if (TRUE DURING PROFILING) {
   A.a();
 } else {
   B.b();
 }

Assuming the second call-site is definite (final, static, w/e), it is not a given that B has been verified when you inline.

(I make the distinction to A as that would have been executed and thus initialized and thus verified.)


I was asking what you see in practice: how much code is structured this way and bails out?

560:8-560:36
Thu Feb 18 16:49:10 2016 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4225059f_3607d86b
UUID: 8259bd47_c8cfcf74
Bytes: 155
Profiling is not related here. This code can try inlining a call that is in a block that was never executed, but whose resolve method hasn't been verified.

560:8-560:36
Thu Feb 18 16:52:09 2016 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 8259bd47_c8cfcf74
UUID: e200b9f1_bbcce780
Bytes: 322
I do understand that. I thought I made that clear, by giving the part about "definite." The whole surrounding was only there to show that even in the root method to be compiled, which has been executed (except for always-jit), this case can happen.

The question remains: Out of curiosity, how much inlining do you "lose?"

560:8-560:36
Thu Feb 18 16:55:07 2016 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e200b9f1_bbcce780
UUID: e247d965_a3ccba80
Bytes: 96
Not sure what you're asking. You'd end up not inlining methods that haven't been verified yet...

