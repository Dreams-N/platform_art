Revision: 522a1d19aab21c3aff3795ae38e43d15ea570a8c
Patch-set: 5
File: compiler/dex/quick/codegen_util.cc

1097:6-1097:44
Wed Mar 25 21:35:51 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 2362b2ee_f7d9431f
Bytes: 190
You'll always push a vector, and so you need both a nullptr and that ugly size() > 0 check in the elf writer. Consider a ternary here, maybe, or rewrite how cfi is handled in CompiledMethod.

1097:6-1097:44
Wed Mar 25 22:31:24 2015 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 2362b2ee_f7d9431f
UUID: 63002af0_61d5926f
Bytes: 238
I don't understand.

In my opinion this is perfectly OK. If the patch is empty, this will create an empty ArrayRef<> which will be nicely forwarded to the CompiledMethod ctor where we shall see it's empty and we will not touch its data().

1097:6-1097:44
Wed Mar 25 22:38:42 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 63002af0_61d5926f
UUID: 2362b2ee_1a13dbe1
Bytes: 218
Ah, yes, I had forgotten that we actually checked against the size, which is weirdly 0 for an arrayref without backing data. That just means the elf-writer should be updated, as you'll never so non-nullptr with size 0.

