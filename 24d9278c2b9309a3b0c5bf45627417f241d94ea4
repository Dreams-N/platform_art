Revision: 24d9278c2b9309a3b0c5bf45627417f241d94ea4
Patch-set: 5
File: compiler/optimizing/nodes.h

4252:0-4256:82
Tue Oct 27 19:00:42 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: b6b19df3_fa1c0535
Bytes: 47
Add a comment/message why you need that DCHECK.

4252:0-4256:82
Mon Nov 02 19:04:53 2015 +0000
Author: David Brazdil <1059815@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: b6b19df3_fa1c0535
UUID: 36204e91_c467c8f7
Bytes: 4
Done

4463:20-4463:79
Tue Oct 27 19:00:42 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: b6b19df3_1a4b7925
Bytes: 64
Add a comment why other types are fixed / those types are fixed.

4463:20-4463:79
Mon Nov 02 19:04:53 2015 +0000
Author: David Brazdil <1059815@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: b6b19df3_1a4b7925
UUID: d63612de_2c98af58
Bytes: 176
It's explained next to the definition of fixed_type_ at the bottom of the class. I didn't feel like it was necessary to repeat it twice. I've extended the comment below though.

File: compiler/optimizing/primitive_type_propagation.cc

30:18-30:32
Tue Oct 27 19:00:42 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 1683491e_8a2bab1b
Bytes: 45
-> are ? The phi constructor marks them live.

30:18-30:32
Mon Nov 02 19:04:53 2015 +0000
Author: David Brazdil <1059815@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 1683491e_8a2bab1b
UUID: 36204e91_645354c0
Bytes: 4
Done

48:0-49:73
Tue Oct 27 19:00:42 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 16c1896c_9a264d55
Bytes: 172
Explain why it's not necessarily a conflict. Also "during typing of inputs" is ReplacePhiInputs? I'd mention it direclty then.

Why don't we type the inputs in this method?

48:0-49:73
Mon Nov 02 19:04:53 2015 +0000
Author: David Brazdil <1059815@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 16c1896c_9a264d55
UUID: d63612de_ec262795
Bytes: 96
Done.
We can't replace them here because the type transition can also be made by Get*Equivalent.

53:0-54:45
Tue Oct 27 19:00:42 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: d67c51f3_eb318dd0
Bytes: 5
ditto

53:0-54:45
Mon Nov 02 19:04:53 2015 +0000
Author: David Brazdil <1059815@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: d67c51f3_eb318dd0
UUID: 760e462a_803d3ca3
Bytes: 55
Didn't want to repeat myself, refers to the case above.

86:0-86:52
Tue Oct 27 19:00:42 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: f69a3588_c42630ef
Bytes: 26
Keep the previous comment?

86:0-86:52
Mon Nov 02 19:04:53 2015 +0000
Author: David Brazdil <1059815@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: f69a3588_c42630ef
UUID: 765c8636_2d543905
Bytes: 4
Done

146:0-146:28
Tue Oct 27 19:00:42 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: b6b19df3_3a503dcd
Bytes: 28
Move this to an '&&' one up?

146:0-146:28
Mon Nov 02 19:04:53 2015 +0000
Author: David Brazdil <1059815@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: b6b19df3_3a503dcd
UUID: f6195673_8222e4e4
Bytes: 4
Done

159:75-160:46
Tue Oct 27 19:00:42 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 36b04d09_db4f332e
Bytes: 12
explain why.

159:75-160:46
Mon Nov 02 19:04:53 2015 +0000
Author: David Brazdil <1059815@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 36b04d09_db4f332e
UUID: 161fca56_8efe8f5c
Bytes: 4
Done

File: compiler/optimizing/ssa_builder.cc

99:0-106:48
Tue Oct 27 19:00:42 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 7671e51a_a567be4f
Bytes: 107
Do we still need this? The reason it was there was because the type propagation could not handle conflicts.

99:0-106:48
Mon Nov 02 19:04:53 2015 +0000
Author: David Brazdil <1059815@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 7671e51a_a567be4f
UUID: 562a227b_e2bcee89
Bytes: 32
Good point, no we don't. Removed

386:15-386:19
Tue Oct 27 19:00:42 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 56b5c1f6_9c5be5df
Bytes: 37
This is odd. When did it become dead?

386:15-386:19
Mon Nov 02 19:04:53 2015 +0000
Author: David Brazdil <1059815@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 56b5c1f6_9c5be5df
UUID: d63612de_67037026
Bytes: 205
Good catch, thanks. It means there is an equivalent but it had a conflict, hence dead. In that case there's no point in turning it back live because it would just conflict again. Updated and comment added.

444:34-444:67
Tue Oct 27 19:00:42 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 36920d67_6bae8107
Bytes: 41
user->AsArraySet()->GetValue() != value ?

444:34-444:67
Mon Nov 02 19:04:53 2015 +0000
Author: David Brazdil <1059815@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 36920d67_6bae8107
UUID: f636b56e_07919a21
Bytes: 184
Not quite. For ArraySet:

  array[x] = x;

the type would not get fixed (to int) despite the use as an index. What works, though, is user->AsArraySet()->GetIndex() == value. Done that.

