Revision: d81cf401e79a4089290008637120237e14ef48d2
Patch-set: 1
File: runtime/arch/x86_64/fault_handler_x86_64.cc

51
Wed Jul 16 21:56:42 2014 +0000
Author: Chao-ying Fu <1010712@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 59ba20ef_f24b28e9
Bytes: 62
This instruction size calculation may be incorrect for x86_64.

51
Wed Jul 16 22:25:37 2014 +0000
Author: Dave Allison <1036486@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 59ba20ef_f24b28e9
UUID: 19c8a874_a2417320
Bytes: 13
Specifically?

51
Wed Jul 16 22:59:29 2014 +0000
Author: Dave Allison <1036486@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 19c8a874_a2417320
UUID: 19c8a874_627bdbd0
Bytes: 271
I'd like to replace this by a proper table-driven solution that will always work.  That can be done in the future though.  The problem with this solution is that if we get the instruction length wrong, the program will crash rather than throwing an appropriate exception.

51
Wed Jul 16 23:34:45 2014 +0000
Author: Chao-ying Fu <1010712@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 19c8a874_a2417320
UUID: 59ba20ef_623627fc
Bytes: 158
0x7f4e433c2c21:               44896558            mov     [rbp + 88], r12d
It reports this is 5 bytes.  But, the issue may be to check the r/m field.  Thanks!

137
Wed Jul 16 22:47:24 2014 +0000
Author: Chao-ying Fu <1010712@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 79c52478_33ec0897
Bytes: 58
Should we check rm =  modrm & 0xb111 here, instead of reg?

181
Wed Jul 16 21:56:42 2014 +0000
Author: Chao-ying Fu <1010712@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 59ba20ef_1218dc0f
Bytes: 88
This is incorrect for 64-bit targets.  We only can access 4 bytes as the method pointer.

181
Wed Jul 16 22:25:37 2014 +0000
Author: Dave Allison <1036486@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 59ba20ef_1218dc0f
UUID: 59ba20ef_0da681ae
Bytes: 26
You can use AsMirrorPtr().

181
Wed Jul 16 22:48:45 2014 +0000
Author: Chao-ying Fu <1010712@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 59ba20ef_0da681ae
UUID: 19c8a874_e2fb6b22
Bytes: 101
Yes.  Ex:
*out_method = reinterpret_cast<StackReference<mirror::ArtMethod>*>(*out_sp)->AsMirrorPtr();

