Revision: e6a1c45aa27807640d1990d2fa2466d11805909e
Patch-set: 6
File: runtime/elf_file.cc

1030:66-1030:75
Thu Jun 19 21:25:24 2014 +0000
Author: Mark P Mendell <1036869@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e43fa9e6_c0b5c00c
Bytes: 9
necessary

1030
Thu Jun 19 22:23:41 2014 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e43fa9e6_c0b5c00c
UUID: c4a70589_d9121fe7
Bytes: 4
Done

1041:0-1043:3
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 04ae7d65_09194d0b
Bytes: 79
the below check now finds all the "interesting sections" so this can be removed

1044:20-1044:24
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: c44c65b5_1cf395c3
Bytes: 155
i think i'd use the full debug_info names here (not just info) for clarify below. str and info are a bit too generic for something which such a long scope.

1063:0-1070:32
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e4932916_b2d506ef
Bytes: 16
lets just do it.

1111:27-1111:53
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e43fa9e6_86de3073
Bytes: 38
should this just be the section count?

1117:31-1117:57
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: c4a70589_4bcc1645
Bytes: 29
again here, all the sections.

1125:0-1126:75
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e43fa9e6_86f750f5
Bytes: 105
I think this is buggy, there is no TEMP_FAILURE_RETRY. probably it would be better to use pread() anyway?

1129:8-1130:21
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: c44c65b5_1c5ef51d
Bytes: 38
Mark, was this just a cut/paste issue?

1137:8-1138:75
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e43fa9e6_46c2686e
Bytes: 175
again, seems wrong, need
TEMP_FAILURE_RETRY(pread...
plus a loop to make sure there aren't short reads. alternatively, we should use seek (but check error code) with ReadFully

1140:8-1140:60
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: c44c65b5_fc986995
Bytes: 28
so is this clobbering yours?

1141:33-1141:55
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e43fa9e6_06c0605d
Bytes: 34
shouldn't they update the sh_size?

1159:40-1159:41
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: c44c65b5_5c1ebdf4
Bytes: 133
this is what made be think that we should debug_info above should be an index, not a pointer. and this is an "Index", not an "Offset"

1227:31-1227:57
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: c44c65b5_1c24354b
Bytes: 15
more to come...

1332
Thu Jun 19 21:25:24 2014 +0000
Author: Mark P Mendell <1036869@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e43fa9e6_803f38a4
Bytes: 216
Note that we need to KEEP the memory around for the rest of execution, so that GDB can access it at any time (in particular if we add more files later.  We can't just keep the last one.  You need a set<> of mappings.

1332
Thu Jun 19 22:23:41 2014 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e43fa9e6_803f38a4
UUID: e43fa9e6_238f4e1d
Bytes: 244
This function is only called once per file per execution so there is no chance of the value being smashed there and it will stay around for as long as the ElfFile is loaded, which is the same lifetime as the jit_elf_image_ used in the top case.

File: runtime/elf_file.h

45:19-45:28
Thu Jun 19 22:27:43 2014 +0000
Author: Brian Carlstrom <1003723@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: c4a70589_d99e9f82
Bytes: 115
it really is just the program header in the above case (nothing to do with sections which has another elf meaning).

