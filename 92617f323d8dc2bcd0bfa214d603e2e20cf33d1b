Revision: 92617f323d8dc2bcd0bfa214d603e2e20cf33d1b
Patch-set: 10
File: compiler/profile_assistant.cc

101:0-121:1
Tue Jan 05 10:25:08 2016 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 6a5f3bcc_26e4f6f5
Bytes: 425
How about a new class for doing the locking/unlocking? For example:

class ScopedLocking {
  const std::vector<uint32_t>& fds_;
  bool success_;

  ScopedLocking(fds) : fds_(fds) {
    success_ = LockAll(fds_);
  }
  ~ScopedLocking() {
    UnlockAll(fds_);
  }
}

And then you'd write:
ScopedLocking prof(profile_files_fd);
if (!prof.Success()) {
  return;
}

ScopedLocking ref_prof(..);
if (!ref_prof.Success()) {
  return
}

101:0-121:1
Thu Jan 07 16:33:25 2016 +0000
Author: Calin Juravle <1022077@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 6a5f3bcc_26e4f6f5
UUID: 8a68ef71_27887a07
Bytes: 59
good idea.
Found out that we already have a class for this.

130:1-160:65
Tue Jan 05 10:25:08 2016 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: ca6e677a_c9e891d5
Bytes: 37
Ditto for a ScopedOpenAllFiles class.

130:1-160:65
Thu Jan 07 16:33:25 2016 +0000
Author: Calin Juravle <1022077@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: ca6e677a_c9e891d5
UUID: 0a54ffaf_63b98293
Bytes: 4
Done

