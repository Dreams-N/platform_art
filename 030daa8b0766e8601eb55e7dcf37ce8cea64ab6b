Revision: 030daa8b0766e8601eb55e7dcf37ce8cea64ab6b
Patch-set: 1
File: compiler/elf_writer_quick.cc

211:0-211:51
Tue May 26 10:21:04 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: cdf3c519_581485c6
Bytes: 81
I haven't completely followed everything, but how are we handling deduped method?

211:0-211:51
Tue May 26 12:15:30 2015 +0000
Author: David Srbecky <1065473@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: cdf3c519_581485c6
UUID: 2d0c61ed_2e24dbda
Bytes: 227
First deduped method gets symbol with [DEDUPED] suffix, other deduped methods with the same address have no symbols to save space (see WriteDebugSymbols below).  Methods are not deduped in the first pace if --debuggable is set.

211:0-211:51
Tue May 26 13:02:57 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 2d0c61ed_2e24dbda
UUID: ed8889a6_c5536ef1
Bytes: 399
Ok, so:
1) Debuggable is not set: we can get something irrelevant as a stack, but the irrelevant names are marked [DEDUPED]
2) Debuggable is set: we get correct stack trace with correct names.

Is that correct?

If a developer gets a crash, will the DEDUPED be visible to her? Will it be obvious what is going on? Wouldn't it be better to not print a method name to not be confusing? Should we care?

211:0-211:51
Tue May 26 13:28:15 2015 +0000
Author: David Srbecky <1065473@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: ed8889a6_c5536ef1
UUID: cdf3c519_9331ce9b
Bytes: 614
Correct.

(However, the names will be available only if dex2oat was run with --include-debug-symbols;  or with --include-cfi with this CL)

The [DEDUPED] suffix is part of the symbol name, so I believe it should be visible in all tools.

Do you mean the deduped methods just have just [DEDUPED] as the method name and nothing else?  Well, on one hand, the printed name has at least 50% chance being wrong and thus misleading.  On the other hand, it must be a function with the exact same behavior so it is still somewhat informative.  I can persuaded either way, and not including the name saves us a bit of space.

