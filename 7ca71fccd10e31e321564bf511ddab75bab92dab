Revision: 7ca71fccd10e31e321564bf511ddab75bab92dab
Patch-set: 5
File: compiler/image_writer.cc

908:27-908:33
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 237f124e_186e867e
Bytes: 23
Vladimir likes emplace.

1029:0-1038:3
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 237f124e_18bcc64e
Bytes: 65
This is not the right function, you're not copying objects... :-)

1063:2-1067:47
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 83c43ed3_198e8d7f
Bytes: 123
For better readability you could consider factoring this into Data* data = GetDataFor(obj, klass); if (data != nullptr) ...

1068:6-1104:51
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 83c43ed3_19b5ed31
Bytes: 34
Put into a separate, named method.

1189:4-1208:5
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 03868e96_b862ffbb
Bytes: 94
All the other fixups are in their own methods (well visitor stuff). Consider moving this, too.

File: compiler/image_writer.h

129:40-129:41
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 237f124e_d88dfe00
Bytes: 35
There's no apostrophe in plurals...

131:4-131:58
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 237f124e_586e4ead
Bytes: 70
This needs to change. People might add heap things after the ArtField.

305:27-305:52
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 83c43ed3_b99db9b3
Bytes: 51
Nicolas says no to this. Please introduce a struct.

File: compiler/utils/dex_cache_arrays_layout.h

84:31-84:86
Fri Apr 10 09:56:22 2015 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 6394aac1_5b166300
Bytes: 189
The problem is that you're using non-static functions to compute values of other members. If you used static functions taking an additional pointer size argument, this wouldn't be an issue.

File: patchoat/patchoat.cc

425:0-465:3
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 237f124e_fba71cb2
Bytes: 18
Separate function.

File: runtime/art_field.cc

51:0-51:71
Fri Apr 10 09:56:22 2015 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: a38a229d_fd4ba735
Bytes: 152
Can you update or remove the comment, please? We have made a deliberate choice to keep the same order as in the dex file to allow binary search by name.

File: runtime/check_jni.cc

996:0-1002:6
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 636d8ab3_931a9c6f
Bytes: 1
?

File: runtime/class_linker.cc

1119:2-1119:46
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 03868e96_18d5ab6f
Bytes: 32
Don't see that that's necessary.

1485:2-1485:50
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 234d525a_3158f05a
Bytes: 89
Why is the order here changed, without any comments? If you had chosen intuitive names...

2928:22-2928:58
Fri Apr 10 09:56:22 2015 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: a38a229d_7d2cf73e
Bytes: 82
We don't GC proxy classes, do we? (Otherwise we would leak memory allocated here.)

File: runtime/class_linker.h

508:2-510:50
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 636d8ab3_f3ce705e
Bytes: 48
Where's the comment what SetupClass is gonna do?

File: runtime/common_throws.cc

21:0-31:37
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 234d525a_f119087a
Bytes: 100
This is missing the art_field include (must be pulling it transitively). Please add for cleanliness.

File: runtime/gc/heap.cc

2713:12-2713:37
Fri Apr 10 09:56:22 2015 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 6394aac1_db24332f
Bytes: 108
I don't think this is still valid. Previously we could have had empty array but now we have nullptr instead.

File: runtime/image.h

149:0-153:28
Fri Apr 10 09:56:22 2015 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 6394aac1_3b3c3742
Bytes: 132
Maybe we should rename this to native object space offset/size with a view of moving more things here (ArtMethod, dex cache arrays).

File: runtime/jdwp/jdwp_event.cc

122:16-122:22
Fri Apr 10 09:56:22 2015 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 6394aac1_bbaa07d0
Bytes: 15
Please realign.

File: runtime/linear_alloc.h

37:0-41:5
Fri Apr 10 09:56:22 2015 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: a38a229d_9d5623b4
Bytes: 89
I don't think the construction of elements should be the responsibility of the allocator.

File: runtime/mirror/class-inl.h

436:2-437:88
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 234d525a_718a78e9
Bytes: 55
Please document why it's now OK to overwrite with null.

File: runtime/mirror/class.h

1157:0-1159:46
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 636d8ab3_f37cb036
Bytes: 26
Is that really still true?

1157:0-1159:46
Fri Apr 10 09:56:22 2015 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 636d8ab3_f37cb036
UUID: 6394aac1_bb720763
Bytes: 77
Please remove. I clearly missed this comment in the field ordering change CL.

1161:41-1161:49
Thu Apr 09 20:06:33 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 636d8ab3_337f0829
Bytes: 1
?

