Revision: 730ac7ffd83d4e64ec9f010638c6f8170552bf44
Patch-set: 3
File: compiler/optimizing/code_generator_arm.h

118:12-119:53
Thu Sep 17 18:35:23 2015 +0000
Author: Calin Juravle <1022077@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 29a37f81_4398866b
Bytes: 348
There's an issue here since these pairs fail the ExpectedPairLayout() test.
Having this exception is rather annoying and I can think of:
a) adding a flag to not check that a pair has the expected layout
b) requesting a proper pair and work around it with various moves.
c) ?

I would go with a) since b) implies a lot of working.
What do you think?

118:12-119:53
Fri Sep 18 07:47:25 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 29a37f81_4398866b
UUID: 4970b318_64d6aa30
Bytes: 57
Could you just change the ABI and make that pair aligned?

File: compiler/optimizing/code_generator_x86.h

114:14-114:55
Thu Sep 17 18:35:23 2015 +0000
Author: Calin Juravle <1022077@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e932471b_214f4eab
Bytes: 149
For x86, we actually block this pair from being use. We don't fail because baseline checks if the individual regs are blocked and not the whole pair.

114:14-114:55
Thu Sep 17 18:42:29 2015 +0000
Author: Mark P Mendell <1036869@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e932471b_214f4eab
UUID: e96fa7e4_bf495ff8
Bytes: 230
Yes, the register allocator assumes only certain pairs are legal, so that it matches ARM conventions.  Arbirtrary pairs aren't supported.

I think you will need a GetSetLongValuePairHigh/Low to get the 2 registers.  Bit of a pain.

114:14-114:55
Fri Sep 18 07:47:25 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e96fa7e4_bf495ff8
UUID: e99a4788_41cc529f
Bytes: 17
ditto: change ABI

114:14-114:55
Fri Sep 18 11:42:06 2015 +0000
Author: Mark P Mendell <1036869@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e99a4788_41cc529f
UUID: 89df0b23_645a1e1c
Bytes: 305
Rather than changing the ABI, which seems a bit drastic, can we have a reference parameter that would contain the high location and return the low location?  The caller could see if the high location is valid, and make a register pair to the high/low parts.  64 bit implementations would leave it invalid.

114:14-114:55
Fri Sep 18 12:40:18 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 89df0b23_645a1e1c
UUID: 89762b11_86748aca
Bytes: 111
Why drastic? We come up with the ABI we want. If it simplifies the compiler, there's no reason not changing it.

