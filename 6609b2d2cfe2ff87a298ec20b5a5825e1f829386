Revision: 6609b2d2cfe2ff87a298ec20b5a5825e1f829386
Patch-set: 9
File: compiler/optimizing/induction_var_analysis.cc

25:20-25:29
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: c4c3a958_355210b7
Bytes: 10
other_loop

25:20-25:29
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: c4c3a958_355210b7
UUID: c42ba915_148a2df8
Bytes: 4
Done

26:2-26:25
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 4486d92e_491c6128
Bytes: 111
nit: early return?
if (other_loop == loop) return false;

Also, please add comments around the different cases.

26:2-26:25
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4486d92e_491c6128
UUID: c42ba915_f48451ee
Bytes: 85
Added comment, but early return seems a bit overkill over such a very short function.

33:47-33:49
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 04b221f6_d7447c21
Bytes: 10
What's mu?

33:47-33:49
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 04b221f6_d7447c21
UUID: e4750d3f_495b42cd
Bytes: 143
Special entry phi node (is used in the paper). Since you are right this has no meaning in our code base, replaced the comments and method name.

36:31-37:51
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 247d65ed_683a0381
Bytes: 17
nit: one per line

36:31-37:51
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 247d65ed_683a0381
UUID: 048f817d_6ebe4aac
Bytes: 4
Done

58:7-59:46
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 24a485b9_30c5c808
Bytes: 39
nit: one line or one statement per line

58:7-59:46
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 24a485b9_30c5c808
UUID: a42a3512_4fcecea7
Bytes: 4
Done

76:6-77:44
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 84bd31cc_f325105f
Bytes: 5
ditto

84:9-85:33
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 24a485b9_50ca4c17
Bytes: 5
ditto

84:9-85:33
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 24a485b9_50ca4c17
UUID: c4700952_567f651b
Bytes: 4
Done

91:9-92:33
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 04a781c0_afd079c2
Bytes: 5
ditto

91:9-92:33
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 04a781c0_afd079c2
UUID: c4700952_f64c511d
Bytes: 4
Done

94:10-94:56
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 04a781c0_cfddbdd9
Bytes: 64
Add a IsVisited helper? (to avoid the map operation dependency).

94:10-94:56
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 04a781c0_cfddbdd9
UUID: 048f817d_6ee72ad2
Bytes: 213
That would require all sorts of setters and getters.

- later edit -
Ah I see you suggested that below too. I could be convinced if you insists, but since this is all in the cc file, I am not sure it matters much?

101:2-101:15
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: c4c3a958_754c8819
Bytes: 28
Why do you need to clear it?

101:2-101:15
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: c4c3a958_754c8819
UUID: a47f9520_ec56c0da
Bytes: 157
Just clearing what is no longer needed.
Note that in a later CL, I want to use a temporary arena, and only copy useful information into a longer lived arena.

155:10-155:24
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 247d65ed_882e5743
Bytes: 34
Add GetState(HInstruction) helper?

155:10-155:24
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 247d65ed_882e5743
UUID: c4700952_d64b5500
Bytes: 9
see above

158:13-158:26
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e4c8ad77_b91b7ba4
Bytes: 23
GetDepth(HInstruction)?

158:13-158:26
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e4c8ad77_b91b7ba4
UUID: 4485f957_da55b4cc
Bytes: 9
see above

196:2-196:7
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 4486d92e_6921255d
Bytes: 6
DCHECK

196:2-196:7
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4486d92e_6921255d
UUID: 048f817d_2ee122bb
Bytes: 163
It is a very cheap test, and if it is not true, the access below to scc_ may be invalid. I would rather have the informative CHECK crash, than some weird behavior?

218:2-220:62
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 84bd31cc_335228b7
Bytes: 68
The comment looks off with the code. Why are you clearing the cycle?

218:2-220:62
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 84bd31cc_335228b7
UUID: a47f9520_0cc54c07
Bytes: 93
Ah, the cycle is in scc_. This cycle_ builds information on the cycle. Added this to comment.

222:18-222:22
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: a4c23555_147ef4d6
Bytes: 9
operation

222:18-222:22
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: a4c23555_147ef4d6
UUID: 048f817d_aea5128c
Bytes: 4
Done

246:16-246:33
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 247d65ed_e825135f
Bytes: 25
what is an internal link?

246:16-246:33
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 247d65ed_e825135f
UUID: 84253145_d5ba6f27
Bytes: 49
internal: within loop
external: from outside loop

247:0-248:50
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e4c8ad77_19546f2a
Bytes: 28
Please add a helper for this

247:0-248:50
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e4c8ad77_19546f2a
UUID: a47f9520_cce744a1
Bytes: 49
That seems a lot of code for this one time thing?

258:0-259:34
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 247d65ed_08642798
Bytes: 48
Please add comments around the Transfer methods.

258:0-259:34
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 247d65ed_08642798
UUID: e4750d3f_0908dab6
Bytes: 4
Done

268:39-268:70
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 24a485b9_10e9a477
Bytes: 17
nit: one per line

268:39-268:70
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 24a485b9_10e9a477
UUID: a47f9520_2c104808
Bytes: 4
Done

269:0-269:37
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 247d65ed_2869eb6e
Bytes: 73
nit: reverse the condition for an early return and avoid the indentation?

269:0-269:37
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 247d65ed_2869eb6e
UUID: c42ba915_b4349995
Bytes: 276
I thought about that (since the indentation is a bit of a pain), but than we would need one extra return nullptr for cases not handled. So I liked that this code was a bit more compact, leaving the single return nullptr at the end for all unhandled cases... What do you think?

274:9-274:32
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 04a781c0_0fe98577
Bytes: 26
nit: one argument per line

274:9-274:32
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 04a781c0_0fe98577
UUID: c42ba915_742fe140
Bytes: 4
Done

283:0-283:27
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: c4c3a958_15b6f477
Bytes: 12
one per line

288:10-288:17
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 84bd31cc_b35d58c3
Bytes: 5
ditto

288:10-288:17
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 84bd31cc_b35d58c3
UUID: 248c8586_dcce0a29
Bytes: 4
Done

299:0-299:37
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: c4c3a958_35bbf05e
Bytes: 13
early return?

299:0-299:37
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: c4c3a958_35bbf05e
UUID: 048f817d_ce55f6cc
Bytes: 10
See above?

304:6-304:24
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 4486d92e_693a0581
Bytes: 12
one per line

304:6-304:24
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 4486d92e_693a0581
UUID: 048f817d_6e4baa31
Bytes: 4
Done

310:0-310:24
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 64b59dd9_baa61143
Bytes: 12
one per line

310:0-310:24
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 64b59dd9_baa61143
UUID: 048f817d_8e484e34
Bytes: 4
Done

321:0-321:20
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: c4c3a958_55c06cc6
Bytes: 13
early return?

321:0-321:20
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: c4c3a958_55c06cc6
UUID: 248c8586_9cd162c8
Bytes: 48
Same argument, although of course subjective :-)

326:0-326:24
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: a4c23555_748d6884
Bytes: 12
one per line

326:0-326:24
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: a4c23555_748d6884
UUID: 4485f957_5af46447
Bytes: 4
Done

338:2-338:7
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 64b59dd9_dab3c57f
Bytes: 6
DCHECK

338:2-338:7
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 64b59dd9_dab3c57f
UUID: 84253145_f57d2bda
Bytes: 33
same argument on follow-up access

339:0-340:28
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: a4c23555_94712405
Bytes: 13
Add a helper?

339:0-340:28
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: a4c23555_94712405
UUID: e430ad80_51e193b9
Bytes: 133
I see you like abstractions :-) 
I have a slight preference on keeping such short stl idioms inline, but if you insis I will rewrite.

343:0-344:30
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 04b221f6_f7da60de
Bytes: 7
helper?

343:0-344:30
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 04b221f6_f7da60de
UUID: 4485f957_da20545c
Bytes: 5
ditto

359:1-361:34
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e4c8ad77_7963a30e
Bytes: 7
helper?

359:1-361:34
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e4c8ad77_7963a30e
UUID: 048f817d_0ec53e07
Bytes: 5
ditto

390:0-393:3
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 247d65ed_6873e35c
Bytes: 7
helper?

414:9-414:24
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 04a781c0_aff95942
Bytes: 62
is it correct to return true if both info1 and info2 are null?

414:9-414:24
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 04a781c0_aff95942
UUID: e4750d3f_c98e528a
Bytes: 71
Yes, that is on purpose, but since you asked I added a comment on that.

File: compiler/optimizing/induction_var_analysis.h

110:19-110:29
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 04a781c0_efda81de
Bytes: 15
induction_class

110:19-110:29
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 04a781c0_efda81de
UUID: 4485f957_4069d897
Bytes: 4
Done

111:16-111:20
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 64b59dd9_7ac559d5
Bytes: 10
operation?

111:16-111:20
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 64b59dd9_7ac559d5
UUID: 048f817d_be9305b0
Bytes: 4
Done

112:19-112:22
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 24a485b9_30eea880
Bytes: 5
left?

112:19-112:22
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 24a485b9_30eea880
UUID: a42a3512_e9079da7
Bytes: 121
Here I prefer to keep using a, b since it is not always a clear left/right situation, but I changed it into op_a and op_b

113:19-113:22
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 84bd31cc_734ca019
Bytes: 6
right?

113:19-113:22
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 84bd31cc_734ca019
UUID: 248c8586_ad5d1a4d
Bytes: 4
Same

114:18-114:23
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 247d65ed_486e1f78
Bytes: 27
what's a fetch instruction?

114:18-114:23
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 247d65ed_486e1f78
UUID: e4750d3f_c31634d8
Bytes: 62
direct reference to a node in the HIR
(so you fetch its value)

151:7-151:12
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 04a781c0_8fd3b5ce
Bytes: 33
Please use GrowableArray instead.

151:7-151:12
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 04a781c0_8fd3b5ce
UUID: c42ba915_f40771a7
Bytes: 4
Done

152:7-152:13
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: a4c23555_54b6ac46
Bytes: 5
ditto

152:7-152:13
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: a4c23555_54b6ac46
UUID: 84253145_55797fe5
Bytes: 4
Done

153:7-153:20
Tue Aug 18 15:56:48 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 64b59dd9_5ac095c6
Bytes: 29
ArenaSafeMap (here and below)

153:7-153:20
Mon Aug 24 17:32:08 2015 +0000
Author: Aart Bik <1074526@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 64b59dd9_5ac095c6
UUID: c4700952_9642adc3
Bytes: 4
Done

