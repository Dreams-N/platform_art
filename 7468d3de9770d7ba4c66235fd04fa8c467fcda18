Revision: 7468d3de9770d7ba4c66235fd04fa8c467fcda18
Patch-set: 1
File: runtime/gc/heap.cc

917:77-918:43
Mon Apr 07 18:04:38 2014 +0000
Author: Hiroshi Yamauchi <1022530@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 59a69bd4_85eca634
Bytes: 37
Can you remind me what state this is?

918
Mon Apr 07 19:05:03 2014 +0000
Author: Mathieu Chartier <1015378@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 59a69bd4_85eca634
UUID: 59a69bd4_e88a2707
Bytes: 145
I think I need to add an if (!CaresAboutPauseTimes()) here since heap transitions could causes trimming and deflation to occur in the foreground.

920:28-920:38
Mon Apr 07 18:04:38 2014 +0000
Author: Hiroshi Yamauchi <1022530@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: f96f4f39_f3809ae3
Bytes: 93
Do we want to lock the runtime shutdown lock here that would prevent new threads starting up?

920
Mon Apr 07 19:05:03 2014 +0000
Author: Mathieu Chartier <1015378@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: f96f4f39_f3809ae3
UUID: f96f4f39_5e1df5f2
Bytes: 116
Is there any reason that would be necessary? In the GC, we don't use the runtime shutdown lock when we do the pause.

920
Mon Apr 07 21:26:20 2014 +0000
Author: Hiroshi Yamauchi <1022530@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: f96f4f39_5e1df5f2
UUID: 59a69bd4_8ea6033c
Bytes: 649
Probably no, in this case, as a thread that's created during this pause wouldn't be interacting with a monitor before the pause ends. As I recall that there have been some SuspendAll() calls where the runtime shutdown lock had to be locked as well, I'm being paranoid. When I see a SuspendAll() call, I tend to start thinking whether a newly created thread would cause a corner case race condition bug.

(As a side note, I think it's worth considering the idea of locking the runtime shutdown lock between SuspendAll() and ResumeAll() as we most likely don't want to shut down while all the threads are suspended, which makes this less error-prone.)

924:2-924:6
Mon Apr 07 18:04:38 2014 +0000
Author: Hiroshi Yamauchi <1022530@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 19734325_ce205282
Bytes: 90
Based on a in-person conversation, we may want to trim only when we are in the background?

924
Mon Apr 07 19:05:03 2014 +0000
Author: Mathieu Chartier <1015378@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 19734325_ce205282
UUID: 19734325_f1409354
Bytes: 4
Done

