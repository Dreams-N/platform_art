Revision: 6289cb9c55aef44736780f6a8abf5280b6fa81a1
Patch-set: 5
File: runtime/arch/arm64/instruction_set_features_arm64.h

83
Mon Nov 10 07:40:55 2014 +0000
Author: Stuart Monteith <1037216@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 1a309fe8_2e9b07d7
Bytes: 106
Future revisions of the A53 can be expected to not have the erratum.
I think this should be more specific.

83
Mon Nov 10 18:15:53 2014 +0000
Author: Ian Rogers <1010118@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 1a309fe8_2e9b07d7
UUID: 5a4f777e_a5da7ef3
Bytes: 82
Do you have a preference? is_buggy_a53_ ? What's the plan with GCC/clang variants?

83
Wed Nov 12 14:10:12 2014 +0000
Author: Matteo Franchin <1037505@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 5a4f777e_a5da7ef3
UUID: fa83cbc2_6891d7b4
Bytes: 353
The erratum affects Cortex-A53 core revisions up to r0p4, namely: r0p0, r0p1, r0p2, r0p3, r0p4. We could go for is_a53_le_r0p4. If, on the other hand, we want to follow gcc/clang, then we should introduce a dedicated flag, e.g. -mfix-cortex-a53-835769, which would default to true, unless it can be proven that the target is not an A53 revision <= r0p4.

File: runtime/arch/x86/instruction_set_features_x86.cc

36:2-36:25
Tue Nov 11 02:31:06 2014 +0000
Author: Ian Rogers <1010118@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 7ac51b23_d43f54aa
Bytes: 61
based on DY's comment, we should remove this and assume SSSE3

36:2-36:25
Tue Nov 11 07:35:53 2014 +0000
Author: Ian Rogers <1010118@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 7ac51b23_d43f54aa
UUID: 5a4f777e_c4da13f5
Bytes: 102
host builds lack SSSE3, so I think this needs to remain. Perhaps default to true ifdef HAVE_ANDROID_OS

36:2-36:25
Wed Nov 12 02:02:53 2014 +0000
Author: Dong-Yuan Chen <1000428@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 5a4f777e_c4da13f5
UUID: 5a7db79e_efe15d58
Bytes: 319
SSSE3 is available since 2006. I am surprise to know that your host does not support SSSE3.

Since this need to support compilation both on target and cross-compiling from host, HAVE_ANDROID_OS may not be a good choice. May be we need an option to overwrite the default for host build if the host doesn't support SSSE3.

37:0-38:26
Tue Nov 11 02:31:06 2014 +0000
Author: Ian Rogers <1010118@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 5a4f777e_31824bda
Bytes: 46
these should "= x86_64;" based on DY's comment

43:15-43:43
Tue Nov 11 02:03:01 2014 +0000
Author: Dong-Yuan Chen <1000428@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 7a80bbc4_56a1148a
Bytes: 266
This seems to be too conservative. We should set the default to match the instruction set features defined in the x86/x86_64 NDK.

According to the NDK supported ABIs, it has "MMX, SSE/2/3, SSSE3" for x86 and "MMX, SSE/2/3, SSSE3, SSE4.1, SSE4.2, POPCNT" for x86_64.

43:15-43:43
Tue Nov 11 02:31:06 2014 +0000
Author: Ian Rogers <1010118@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 7a80bbc4_56a1148a
UUID: 7ac51b23_14e15ce1
Bytes: 70
for clarity I've commented above. Do you want a separate POPCNT field?

43:15-43:43
Wed Nov 12 02:02:53 2014 +0000
Author: Dong-Yuan Chen <1000428@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 7ac51b23_14e15ce1
UUID: 7a80bbc4_f9f4d366
Bytes: 80
POPCNT is less likely to be generated by the compiler. Hence we can skip POPCNT.

