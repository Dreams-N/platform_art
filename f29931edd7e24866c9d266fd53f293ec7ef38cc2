Revision: f29931edd7e24866c9d266fd53f293ec7ef38cc2
Patch-set: 1
File: compiler/optimizing/intrinsics_arm64.cc

624:0-624:41
Wed Jun 29 11:25:16 2016 +0000
Author: Roland Levillain <1052644@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e0152784_c592da11
Bytes: 22
Fits on a single line.

624:0-624:41
Tue Jul 05 12:38:45 2016 +0000
Author: Xueliang Zhong <1096678@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e0152784_c592da11
UUID: bde35a1e_2f5705ba
Bytes: 4
Done

625:39-625:40
Wed Jun 29 11:25:16 2016 +0000
Author: Roland Levillain <1052644@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e0152784_e59556fc
Bytes: 12
Extra space.

625:39-625:40
Tue Jul 05 12:38:45 2016 +0000
Author: Xueliang Zhong <1096678@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e0152784_e59556fc
UUID: bd519aaa_9c2e65ee
Bytes: 4
Done

632:11-632:12
Wed Jun 29 11:25:16 2016 +0000
Author: Roland Levillain <1052644@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: e0152784_a506be4d
Bytes: 12
Extra space.

632:11-632:12
Tue Jul 05 12:38:45 2016 +0000
Author: Xueliang Zhong <1096678@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: e0152784_a506be4d
UUID: 7d0f22b2_0d49f5a5
Bytes: 4
Done

637:5-637:28
Tue Jun 28 22:55:13 2016 +0000
Author: Hans Boehm <1042828@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 80bb8b9f_9f1c87bf
Bytes: 35
Hopefully generates zero for a NaN?

637:5-637:28
Wed Jun 29 09:34:02 2016 +0000
Author: Xueliang Zhong <1096678@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 80bb8b9f_9f1c87bf
UUID: e0152784_0514f29a
Bytes: 609
Yes, FCVTAS generates zero for NaN inputs.

This FCVTAS is the one we found in ARM64 ISA which is closest to Java 8's Math.round() definition.
The only difference is that it has different rounding direction for negative 'half' values. That's why we need a few instructions below to check and handle these negative 'half' values.

We actually have art/test/082-inline-execute/Main.java test to test Math.round implementation. The test cases cover inputs like NaN, +/-0.0, 0.4999999701976776123046875, +/-infinity, floating-point values which are bigger or smaller than Integer.MAX_VALUE/Integer.MIN_VALUE, etc.

646:5-646:9
Tue Jul 05 12:38:45 2016 +0000
Author: Xueliang Zhong <1096678@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 9dde9659_cb64f5a0
Bytes: 172
Here is why the 580-checker-round test failed on this patch. Inside this Fcmp, VIXL also uses UseScratchRegisterScope register which trashes tmp_fp.
Fixed in the new patch.

646:5-646:9
Tue Jul 05 12:48:36 2016 +0000
Author: Roland Levillain <1052644@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 9dde9659_cb64f5a0
UUID: bd519aaa_3c407190
Bytes: 80
This is strange; I thought UseScratchRegisterScope would prevent register reuse.

