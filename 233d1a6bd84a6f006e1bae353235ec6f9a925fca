Revision: 233d1a6bd84a6f006e1bae353235ec6f9a925fca
Patch-set: 2
File: build/Android.common_test.mk

44
Fri Oct 30 21:05:13 2015 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 161fca56_637d8cff
Bytes: 74
Do we want this on by default? It might also hide logs from build servers.

44
Fri Oct 30 22:42:48 2015 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 161fca56_637d8cff
UUID: 765c8636_50a4a2c8
Bytes: 162
It will only hide the large number of 

test-...-404-testing-something32 RUNNING

all errors are still printed and the overall status is printed at the end still.

44
Mon Nov 02 19:11:51 2015 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 765c8636_50a4a2c8
UUID: 760e462a_11b3bc11
Bytes: 197
I'm not sure why this is desirable (by default), doesn't it look like nothing is happening if we remove this?

What if a test is truly not running, we have to wait until the summary to notice this?

44
Mon Nov 02 21:18:15 2015 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 760e462a_11b3bc11
UUID: f6195673_52f7f5b6
Bytes: 766
The tests are still noted as being run by the normal make output. IMO this is no different with this than what we get for normal build rules. For example we see: 

    [ 12% 505/4186] build test-art-host-run-test-debug-prebuild-default-relocate-ntrace-cms-checkjni-image-npictest-ndebuggable-123-compiler-regressions-mt64

instead of the RUNNING...PASSED for 6 lines.

If a test is being skipped it will be noted at the end. I don't feel that these notes give any real useful information. It is easy to check if a test is skipped at the end or by looking in Android.run-test.mk.

I think this is desirable because right now if I run a clean test-art-host I cannot even see a full listing of all passed/skipped tests because it went past my scrollback (of 5000 lines)

44
Mon Nov 02 21:28:44 2015 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: f6195673_52f7f5b6
UUID: 96401a44_0a85cf2d
Bytes: 1294
Would you be able to just paste some before/after examples?

This is how it looks now:

[ 96% 5715/5906] build test-art-host-run-test-debug-prebuild-interpreter-relocate-ntrace-cms-checkjni-image-npictest-ndebuggable-461-get-reference-vreg32
test-art-host-run-test-debug-prebuild-interpreter-relocate-ntrace-cms-checkjni-image-npictest-ndebuggable-448-multiple-returns32 RUNNING
/usr/local/google/buildbot/src/googleplex-android/master-art-host/art/test/448-multiple-returns: building...
/usr/local/google/buildbot/src/googleplex-android/master-art-host/art/test/448-multiple-returns: running...
/usr/local/google/buildbot/src/googleplex-android/master-art-host/art/test/448-multiple-returns: succeeded!
test-art-host-run-test-debug-prebuild-interpreter-relocate-ntrace-cms-checkjni-image-npictest-ndebuggable-448-multiple-r

I can see how the first RUNNINGs might be redundant, but the rest is a clear signal that it indeed actually built and ran and passed, this lets us track down issues potentially faster without having to do a full repro every time.

------
Nothing is stopping anyone from having their own individual defaults in a bashrc (or increasing their scrollback which is the first thing we recommend to newcomers), the question is does it make sense to have this on for everyone.

File: test/run-test

358:19-358:30
Fri Oct 30 21:05:13 2015 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 765c8636_4d752dd6
Bytes: 25
&1 instead of /dev/stdout

358:6-358:17
Fri Oct 30 21:05:13 2015 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 760e462a_001c8c53
Bytes: 111
Named file descriptors were only introduced in bash 4.1, this won't work on mac os x where we still use bash 3.

358:19-358:30
Fri Oct 30 22:42:48 2015 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 765c8636_4d752dd6
UUID: 7643a650_6977c970
Bytes: 4
Done

358:6-358:17
Fri Oct 30 22:42:48 2015 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 760e462a_001c8c53
UUID: 36204e91_cf7fe142
Bytes: 59
Make a version check and figure it out manually if we fail.

359:19-359:30
Fri Oct 30 21:05:13 2015 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 760e462a_202790a5
Bytes: 2
&2

359:19-359:30
Fri Oct 30 22:42:48 2015 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 760e462a_202790a5
UUID: 96401a44_19040fa2
Bytes: 4
Done

365
Fri Oct 30 21:05:13 2015 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 562a227b_37ffdad1
Bytes: 126
Since you already pass through most of the echoes through here, this part can do the flag check instead of doing the redirect.

365
Fri Oct 30 22:42:48 2015 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 562a227b_37ffdad1
UUID: 562a227b_825aca33
Bytes: 58
we need the redirects to get rid of the not-really errors.

366
Fri Oct 30 21:05:13 2015 +0000
Author: Igor Murashkin <1021471@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: f6195673_c2d33c29
Bytes: 4
"$@"

366
Fri Oct 30 22:42:48 2015 +0000
Author: Alex Light <1047769@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: f6195673_c2d33c29
UUID: 161fca56_0ed71f42
Bytes: 4
Done

