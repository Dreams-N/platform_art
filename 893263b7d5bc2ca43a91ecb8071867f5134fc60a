Revision: 893263b7d5bc2ca43a91ecb8071867f5134fc60a
Patch-set: 2
File: runtime/class_linker.cc

1089:8-1089:16
Wed Mar 05 19:40:23 2014 +0000
Author: Hiroshi Yamauchi <1022530@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 3cae3566_95c6ae35
Bytes: 322
Should we somehow defend (eg with a DCHECK) against the possibility that this callback may move an object, as that would make the Class* pointers in new_class_roots_ (if not empty) invalid, if that happens? I assume this does not happen as of now, but it'd be nice to be able to defend it if it happens in a future change.

1089
Wed Mar 05 20:40:21 2014 +0000
Author: Mathieu Chartier <1015378@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 3cae3566_95c6ae35
UUID: 3c80f5c3_3f0a2bb7
Bytes: 45
Added a comment describing this in runtime.h.

File: runtime/intern_table.h

69:68-69:73
Wed Mar 05 19:40:23 2014 +0000
Author: Hiroshi Yamauchi <1022530@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 3cae3566_f5212283
Bytes: 82
Is it more consistent if this param has a default value of kVisitRootFlagAllRoots?

69
Wed Mar 05 20:40:21 2014 +0000
Author: Mathieu Chartier <1015378@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 3cae3566_f5212283
UUID: 5c6be9dc_2bebd160
Bytes: 101
Doable if we move VisitRootsFlags to be in it's own header file. Ill consider doing it in another CL.

File: runtime/runtime.h

71:0-71:4
Wed Mar 05 19:40:23 2014 +0000
Author: Hiroshi Yamauchi <1022530@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: dc76f9c4_e1c40dd7
Bytes: 346
So, about the usage of VisitRootFlags,

One of AllRoots and NewRoots is allowed (or effective).
One of StartLoggingNewRoots and StopLoggingNewRoots is allowed (or effective).
ClearRootLog can be combined with any other flag, but it clears the logs after a root scan (if effective).

Right?

Is it worth leaving a brief comment on this convention?

71
Wed Mar 05 20:40:21 2014 +0000
Author: Mathieu Chartier <1015378@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: dc76f9c4_e1c40dd7
UUID: 5c6be9dc_ebf4f93b
Bytes: 4
Done

