= AndroidGCTest-Java

AndroidGCTest is a GC intensive workload for android GC performance evalution and analysis. it is different from the Java GCTest. and it is based on real-world applications. We studied memory allocation behavior of many real android applications, and developed AndroidGCTest based on the investigation result, and take it as one of the important workloads that help on GC analysis.

Real applications allocate varied size objects, out study show allocated object size distribution has almost same trend in most real android applications. Allocated objects have different lifetime in real applications, and their lifetime seems to have relationship to their size. And more and more real applications allocate objects parallel in multiple threads. The object size distribution, object lifetime and multi-threading allocation behaviour have signaficant impact to the efficiency of design of runtime memory management and GC. AndroidGCTest is developed based on data collection and analysis of many typical android application in multiple categories. It tries to mimic object size distribution, object lifetime and the relationship between lifetime and size, multi-threading allocation behaviour in real applications.

== Matrics

* The Primary metric of AndroidGCTest is total execution time.
  It includes object allocation time, GC relevant time in mutator thread, which can reflect GC efficiency and object allocation throughput.

* Other metrics include heap footprint and bytes allocated.
  Heap footprint is the size of private dirty pages consumed by zygote heap, reported by android.os.Debug.getMemInfo().
  Bytes allocated is reported as (java.lang.Runtime.getRuntime().totalMemory() - java.lang.Runtime.getRuntime().freeMemory()).

* The workload also reports total time and pause time of each GC activity.
  These data are gotten from Logcat, so only GC cycle whose pause time or total time is larger than threshold is reported.

== Requirements

In order to use AndroidGCTest, you will need to have an android device with android verison equal or later than 4.0(SDK API level >= 14). Previous version of android was not guaranteed to sucessfully run this workload.

== Build

=== Build in command line:
We have made an Android.mk under the project root folder.
You can build the workload under Android Project Source tree.
The Android Source version should be later or equal to 4.0 (SDK API level >= 14)
following steps to build AndroidGCTest.apk
* From the [ANDROID_ROOT] run:
  build/envsetup.sh
  lunch <target>
* Now goto art/workloads/AndroidGCTest/ run:
  mm or mmm

By default, this will build the AndroidGCTest.apk and save it into:
[ANDROID_ROOT]/art/workloads/AndroidGCTest/bin/AndroidGCTest/

===Build in Ecilpse:
* The minimum android SDK version should be larger than 10.
* Start eclipse and click File -> import menu, the import dialog will pop up.
* Choose General -> Existing Projects into Workspace, and click next.
* Set the root directory to the path to .project file, AndroidGCTest will show up, select it and click finish.
* Now AndroidGCTest project is imported into eclipse, and eclipse will build this project automatically.

== Run Rule
The AndroidGCTest can both run in GUI or commandline.
Please refer AndroidGCTest-RunRules.txt for details.
