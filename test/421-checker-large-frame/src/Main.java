/*
 * Copyright (C) 2014 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// Note that $opt$ is a marker for the optimizing compiler to ensure
// it does compile the method.
public class Main {

  public static void assertEquals(long expected, long result) {
    if (expected != result) {
      throw new Error("Expected: " + expected + ", found: " + result);
    }
  }

  public static void main(String[] args) {
    // Sum[i = 0..399](i) = 399 * 400 / 2 = 79800L.
    assertEquals(79800L, $opt$stopconstantfolding$LargeFrame());
  }

  // Ask the compiler not to perform constant folding to preserve all
  // the local variables of this method, so that as to force the
  // compiler to allocate these variables on the stack.

  /// CHECK-START: long Main.$opt$stopconstantfolding$LargeFrame() constant_folding (after)
  /// CHECK-DAG:     <<LongConst0:j\d+>>    LongConstant 0
  /// CHECK-DAG:     <<LongConst1:j\d+>>    LongConstant 1
  /// CHECK-DAG:     <<LongConst2:j\d+>>    LongConstant 2
  //  ...
  /// CHECK-DAG:     <<LongConst398:j\d+>>  LongConstant 398
  /// CHECK-DAG:     <<LongConst399:j\d+>>  LongConstant 399
  /// CHECK-DAG:     <<IntConst0:i\d+>>     IntConstant 0
  /// CHECK-DAG:     <<AddTo1:j\d+>>        Add [<<LongConst1>>,<<LongConst0>>]
  /// CHECK-DAG:     <<AddTo2:j\d+>>        Add [<<LongConst2>>,<<AddTo1>>]
  //  ...
  /// CHECK-DAG:     <<AddTo398:j\d+>>      Add [<<LongConst398>>,<<AddTo397:j\d+>>]
  /*
   * Note: The following `Add` instruction is placed after the
   * previous to force Checker to do a backward verification and have
   * it match `AddTo397` properly, as there are many Add instructions
   * in this program.
   */
  /// CHECK-DAG:     <<AddTo397>>           Add
  /// CHECK-DAG:     <<AddTo399:j\d+>>      Add [<<LongConst399>>,<<AddTo398>>]
  /// CHECK-DAG:     <<Compare:i\d+>>       Compare [<<AddTo398>>,<<AddTo399>>]
  /// CHECK-DAG:     <<NotEqual:z\d+>>      NotEqual [<<Compare>>,<<IntConst0>>]
  /// CHECK-DAG:                            If [<<NotEqual>>]

  static long $opt$stopconstantfolding$LargeFrame() {
    long l0 = 0L;
    long l1 = 1L;
    long l2 = 2L;
    long l3 = 3L;
    long l4 = 4L;
    long l5 = 5L;
    long l6 = 6L;
    long l7 = 7L;
    long l8 = 8L;
    long l9 = 9L;
    long l10 = 10L;
    long l11 = 11L;
    long l12 = 12L;
    long l13 = 13L;
    long l14 = 14L;
    long l15 = 15L;
    long l16 = 16L;
    long l17 = 17L;
    long l18 = 18L;
    long l19 = 19L;
    long l20 = 20L;
    long l21 = 21L;
    long l22 = 22L;
    long l23 = 23L;
    long l24 = 24L;
    long l25 = 25L;
    long l26 = 26L;
    long l27 = 27L;
    long l28 = 28L;
    long l29 = 29L;
    long l30 = 30L;
    long l31 = 31L;
    long l32 = 32L;
    long l33 = 33L;
    long l34 = 34L;
    long l35 = 35L;
    long l36 = 36L;
    long l37 = 37L;
    long l38 = 38L;
    long l39 = 39L;
    long l40 = 40L;
    long l41 = 41L;
    long l42 = 42L;
    long l43 = 43L;
    long l44 = 44L;
    long l45 = 45L;
    long l46 = 46L;
    long l47 = 47L;
    long l48 = 48L;
    long l49 = 49L;
    long l50 = 50L;
    long l51 = 51L;
    long l52 = 52L;
    long l53 = 53L;
    long l54 = 54L;
    long l55 = 55L;
    long l56 = 56L;
    long l57 = 57L;
    long l58 = 58L;
    long l59 = 59L;
    long l60 = 60L;
    long l61 = 61L;
    long l62 = 62L;
    long l63 = 63L;
    long l64 = 64L;
    long l65 = 65L;
    long l66 = 66L;
    long l67 = 67L;
    long l68 = 68L;
    long l69 = 69L;
    long l70 = 70L;
    long l71 = 71L;
    long l72 = 72L;
    long l73 = 73L;
    long l74 = 74L;
    long l75 = 75L;
    long l76 = 76L;
    long l77 = 77L;
    long l78 = 78L;
    long l79 = 79L;
    long l80 = 80L;
    long l81 = 81L;
    long l82 = 82L;
    long l83 = 83L;
    long l84 = 84L;
    long l85 = 85L;
    long l86 = 86L;
    long l87 = 87L;
    long l88 = 88L;
    long l89 = 89L;
    long l90 = 90L;
    long l91 = 91L;
    long l92 = 92L;
    long l93 = 93L;
    long l94 = 94L;
    long l95 = 95L;
    long l96 = 96L;
    long l97 = 97L;
    long l98 = 98L;
    long l99 = 99L;
    long l100 = 100L;
    long l101 = 101L;
    long l102 = 102L;
    long l103 = 103L;
    long l104 = 104L;
    long l105 = 105L;
    long l106 = 106L;
    long l107 = 107L;
    long l108 = 108L;
    long l109 = 109L;
    long l110 = 110L;
    long l111 = 111L;
    long l112 = 112L;
    long l113 = 113L;
    long l114 = 114L;
    long l115 = 115L;
    long l116 = 116L;
    long l117 = 117L;
    long l118 = 118L;
    long l119 = 119L;
    long l120 = 120L;
    long l121 = 121L;
    long l122 = 122L;
    long l123 = 123L;
    long l124 = 124L;
    long l125 = 125L;
    long l126 = 126L;
    long l127 = 127L;
    long l128 = 128L;
    long l129 = 129L;
    long l130 = 130L;
    long l131 = 131L;
    long l132 = 132L;
    long l133 = 133L;
    long l134 = 134L;
    long l135 = 135L;
    long l136 = 136L;
    long l137 = 137L;
    long l138 = 138L;
    long l139 = 139L;
    long l140 = 140L;
    long l141 = 141L;
    long l142 = 142L;
    long l143 = 143L;
    long l144 = 144L;
    long l145 = 145L;
    long l146 = 146L;
    long l147 = 147L;
    long l148 = 148L;
    long l149 = 149L;
    long l150 = 150L;
    long l151 = 151L;
    long l152 = 152L;
    long l153 = 153L;
    long l154 = 154L;
    long l155 = 155L;
    long l156 = 156L;
    long l157 = 157L;
    long l158 = 158L;
    long l159 = 159L;
    long l160 = 160L;
    long l161 = 161L;
    long l162 = 162L;
    long l163 = 163L;
    long l164 = 164L;
    long l165 = 165L;
    long l166 = 166L;
    long l167 = 167L;
    long l168 = 168L;
    long l169 = 169L;
    long l170 = 170L;
    long l171 = 171L;
    long l172 = 172L;
    long l173 = 173L;
    long l174 = 174L;
    long l175 = 175L;
    long l176 = 176L;
    long l177 = 177L;
    long l178 = 178L;
    long l179 = 179L;
    long l180 = 180L;
    long l181 = 181L;
    long l182 = 182L;
    long l183 = 183L;
    long l184 = 184L;
    long l185 = 185L;
    long l186 = 186L;
    long l187 = 187L;
    long l188 = 188L;
    long l189 = 189L;
    long l190 = 190L;
    long l191 = 191L;
    long l192 = 192L;
    long l193 = 193L;
    long l194 = 194L;
    long l195 = 195L;
    long l196 = 196L;
    long l197 = 197L;
    long l198 = 198L;
    long l199 = 199L;
    long l200 = 200L;
    long l201 = 201L;
    long l202 = 202L;
    long l203 = 203L;
    long l204 = 204L;
    long l205 = 205L;
    long l206 = 206L;
    long l207 = 207L;
    long l208 = 208L;
    long l209 = 209L;
    long l210 = 210L;
    long l211 = 211L;
    long l212 = 212L;
    long l213 = 213L;
    long l214 = 214L;
    long l215 = 215L;
    long l216 = 216L;
    long l217 = 217L;
    long l218 = 218L;
    long l219 = 219L;
    long l220 = 220L;
    long l221 = 221L;
    long l222 = 222L;
    long l223 = 223L;
    long l224 = 224L;
    long l225 = 225L;
    long l226 = 226L;
    long l227 = 227L;
    long l228 = 228L;
    long l229 = 229L;
    long l230 = 230L;
    long l231 = 231L;
    long l232 = 232L;
    long l233 = 233L;
    long l234 = 234L;
    long l235 = 235L;
    long l236 = 236L;
    long l237 = 237L;
    long l238 = 238L;
    long l239 = 239L;
    long l240 = 240L;
    long l241 = 241L;
    long l242 = 242L;
    long l243 = 243L;
    long l244 = 244L;
    long l245 = 245L;
    long l246 = 246L;
    long l247 = 247L;
    long l248 = 248L;
    long l249 = 249L;
    long l250 = 250L;
    long l251 = 251L;
    long l252 = 252L;
    long l253 = 253L;
    long l254 = 254L;
    long l255 = 255L;
    long l256 = 256L;
    long l257 = 257L;
    long l258 = 258L;
    long l259 = 259L;
    long l260 = 260L;
    long l261 = 261L;
    long l262 = 262L;
    long l263 = 263L;
    long l264 = 264L;
    long l265 = 265L;
    long l266 = 266L;
    long l267 = 267L;
    long l268 = 268L;
    long l269 = 269L;
    long l270 = 270L;
    long l271 = 271L;
    long l272 = 272L;
    long l273 = 273L;
    long l274 = 274L;
    long l275 = 275L;
    long l276 = 276L;
    long l277 = 277L;
    long l278 = 278L;
    long l279 = 279L;
    long l280 = 280L;
    long l281 = 281L;
    long l282 = 282L;
    long l283 = 283L;
    long l284 = 284L;
    long l285 = 285L;
    long l286 = 286L;
    long l287 = 287L;
    long l288 = 288L;
    long l289 = 289L;
    long l290 = 290L;
    long l291 = 291L;
    long l292 = 292L;
    long l293 = 293L;
    long l294 = 294L;
    long l295 = 295L;
    long l296 = 296L;
    long l297 = 297L;
    long l298 = 298L;
    long l299 = 299L;
    long l300 = 300L;
    long l301 = 301L;
    long l302 = 302L;
    long l303 = 303L;
    long l304 = 304L;
    long l305 = 305L;
    long l306 = 306L;
    long l307 = 307L;
    long l308 = 308L;
    long l309 = 309L;
    long l310 = 310L;
    long l311 = 311L;
    long l312 = 312L;
    long l313 = 313L;
    long l314 = 314L;
    long l315 = 315L;
    long l316 = 316L;
    long l317 = 317L;
    long l318 = 318L;
    long l319 = 319L;
    long l320 = 320L;
    long l321 = 321L;
    long l322 = 322L;
    long l323 = 323L;
    long l324 = 324L;
    long l325 = 325L;
    long l326 = 326L;
    long l327 = 327L;
    long l328 = 328L;
    long l329 = 329L;
    long l330 = 330L;
    long l331 = 331L;
    long l332 = 332L;
    long l333 = 333L;
    long l334 = 334L;
    long l335 = 335L;
    long l336 = 336L;
    long l337 = 337L;
    long l338 = 338L;
    long l339 = 339L;
    long l340 = 340L;
    long l341 = 341L;
    long l342 = 342L;
    long l343 = 343L;
    long l344 = 344L;
    long l345 = 345L;
    long l346 = 346L;
    long l347 = 347L;
    long l348 = 348L;
    long l349 = 349L;
    long l350 = 350L;
    long l351 = 351L;
    long l352 = 352L;
    long l353 = 353L;
    long l354 = 354L;
    long l355 = 355L;
    long l356 = 356L;
    long l357 = 357L;
    long l358 = 358L;
    long l359 = 359L;
    long l360 = 360L;
    long l361 = 361L;
    long l362 = 362L;
    long l363 = 363L;
    long l364 = 364L;
    long l365 = 365L;
    long l366 = 366L;
    long l367 = 367L;
    long l368 = 368L;
    long l369 = 369L;
    long l370 = 370L;
    long l371 = 371L;
    long l372 = 372L;
    long l373 = 373L;
    long l374 = 374L;
    long l375 = 375L;
    long l376 = 376L;
    long l377 = 377L;
    long l378 = 378L;
    long l379 = 379L;
    long l380 = 380L;
    long l381 = 381L;
    long l382 = 382L;
    long l383 = 383L;
    long l384 = 384L;
    long l385 = 385L;
    long l386 = 386L;
    long l387 = 387L;
    long l388 = 388L;
    long l389 = 389L;
    long l390 = 390L;
    long l391 = 391L;
    long l392 = 392L;
    long l393 = 393L;
    long l394 = 394L;
    long l395 = 395L;
    long l396 = 396L;
    long l397 = 397L;
    long l398 = 398L;
    long l399 = 399L;
    l1 += l0;
    l2 += l1;
    l3 += l2;
    l4 += l3;
    l5 += l4;
    l6 += l5;
    l7 += l6;
    l8 += l7;
    l9 += l8;
    l10 += l9;
    l11 += l10;
    l12 += l11;
    l13 += l12;
    l14 += l13;
    l15 += l14;
    l16 += l15;
    l17 += l16;
    l18 += l17;
    l19 += l18;
    l20 += l19;
    l21 += l20;
    l22 += l21;
    l23 += l22;
    l24 += l23;
    l25 += l24;
    l26 += l25;
    l27 += l26;
    l28 += l27;
    l29 += l28;
    l30 += l29;
    l31 += l30;
    l32 += l31;
    l33 += l32;
    l34 += l33;
    l35 += l34;
    l36 += l35;
    l37 += l36;
    l38 += l37;
    l39 += l38;
    l40 += l39;
    l41 += l40;
    l42 += l41;
    l43 += l42;
    l44 += l43;
    l45 += l44;
    l46 += l45;
    l47 += l46;
    l48 += l47;
    l49 += l48;
    l50 += l49;
    l51 += l50;
    l52 += l51;
    l53 += l52;
    l54 += l53;
    l55 += l54;
    l56 += l55;
    l57 += l56;
    l58 += l57;
    l59 += l58;
    l60 += l59;
    l61 += l60;
    l62 += l61;
    l63 += l62;
    l64 += l63;
    l65 += l64;
    l66 += l65;
    l67 += l66;
    l68 += l67;
    l69 += l68;
    l70 += l69;
    l71 += l70;
    l72 += l71;
    l73 += l72;
    l74 += l73;
    l75 += l74;
    l76 += l75;
    l77 += l76;
    l78 += l77;
    l79 += l78;
    l80 += l79;
    l81 += l80;
    l82 += l81;
    l83 += l82;
    l84 += l83;
    l85 += l84;
    l86 += l85;
    l87 += l86;
    l88 += l87;
    l89 += l88;
    l90 += l89;
    l91 += l90;
    l92 += l91;
    l93 += l92;
    l94 += l93;
    l95 += l94;
    l96 += l95;
    l97 += l96;
    l98 += l97;
    l99 += l98;
    l100 += l99;
    l101 += l100;
    l102 += l101;
    l103 += l102;
    l104 += l103;
    l105 += l104;
    l106 += l105;
    l107 += l106;
    l108 += l107;
    l109 += l108;
    l110 += l109;
    l111 += l110;
    l112 += l111;
    l113 += l112;
    l114 += l113;
    l115 += l114;
    l116 += l115;
    l117 += l116;
    l118 += l117;
    l119 += l118;
    l120 += l119;
    l121 += l120;
    l122 += l121;
    l123 += l122;
    l124 += l123;
    l125 += l124;
    l126 += l125;
    l127 += l126;
    l128 += l127;
    l129 += l128;
    l130 += l129;
    l131 += l130;
    l132 += l131;
    l133 += l132;
    l134 += l133;
    l135 += l134;
    l136 += l135;
    l137 += l136;
    l138 += l137;
    l139 += l138;
    l140 += l139;
    l141 += l140;
    l142 += l141;
    l143 += l142;
    l144 += l143;
    l145 += l144;
    l146 += l145;
    l147 += l146;
    l148 += l147;
    l149 += l148;
    l150 += l149;
    l151 += l150;
    l152 += l151;
    l153 += l152;
    l154 += l153;
    l155 += l154;
    l156 += l155;
    l157 += l156;
    l158 += l157;
    l159 += l158;
    l160 += l159;
    l161 += l160;
    l162 += l161;
    l163 += l162;
    l164 += l163;
    l165 += l164;
    l166 += l165;
    l167 += l166;
    l168 += l167;
    l169 += l168;
    l170 += l169;
    l171 += l170;
    l172 += l171;
    l173 += l172;
    l174 += l173;
    l175 += l174;
    l176 += l175;
    l177 += l176;
    l178 += l177;
    l179 += l178;
    l180 += l179;
    l181 += l180;
    l182 += l181;
    l183 += l182;
    l184 += l183;
    l185 += l184;
    l186 += l185;
    l187 += l186;
    l188 += l187;
    l189 += l188;
    l190 += l189;
    l191 += l190;
    l192 += l191;
    l193 += l192;
    l194 += l193;
    l195 += l194;
    l196 += l195;
    l197 += l196;
    l198 += l197;
    l199 += l198;
    l200 += l199;
    l201 += l200;
    l202 += l201;
    l203 += l202;
    l204 += l203;
    l205 += l204;
    l206 += l205;
    l207 += l206;
    l208 += l207;
    l209 += l208;
    l210 += l209;
    l211 += l210;
    l212 += l211;
    l213 += l212;
    l214 += l213;
    l215 += l214;
    l216 += l215;
    l217 += l216;
    l218 += l217;
    l219 += l218;
    l220 += l219;
    l221 += l220;
    l222 += l221;
    l223 += l222;
    l224 += l223;
    l225 += l224;
    l226 += l225;
    l227 += l226;
    l228 += l227;
    l229 += l228;
    l230 += l229;
    l231 += l230;
    l232 += l231;
    l233 += l232;
    l234 += l233;
    l235 += l234;
    l236 += l235;
    l237 += l236;
    l238 += l237;
    l239 += l238;
    l240 += l239;
    l241 += l240;
    l242 += l241;
    l243 += l242;
    l244 += l243;
    l245 += l244;
    l246 += l245;
    l247 += l246;
    l248 += l247;
    l249 += l248;
    l250 += l249;
    l251 += l250;
    l252 += l251;
    l253 += l252;
    l254 += l253;
    l255 += l254;
    l256 += l255;
    l257 += l256;
    l258 += l257;
    l259 += l258;
    l260 += l259;
    l261 += l260;
    l262 += l261;
    l263 += l262;
    l264 += l263;
    l265 += l264;
    l266 += l265;
    l267 += l266;
    l268 += l267;
    l269 += l268;
    l270 += l269;
    l271 += l270;
    l272 += l271;
    l273 += l272;
    l274 += l273;
    l275 += l274;
    l276 += l275;
    l277 += l276;
    l278 += l277;
    l279 += l278;
    l280 += l279;
    l281 += l280;
    l282 += l281;
    l283 += l282;
    l284 += l283;
    l285 += l284;
    l286 += l285;
    l287 += l286;
    l288 += l287;
    l289 += l288;
    l290 += l289;
    l291 += l290;
    l292 += l291;
    l293 += l292;
    l294 += l293;
    l295 += l294;
    l296 += l295;
    l297 += l296;
    l298 += l297;
    l299 += l298;
    l300 += l299;
    l301 += l300;
    l302 += l301;
    l303 += l302;
    l304 += l303;
    l305 += l304;
    l306 += l305;
    l307 += l306;
    l308 += l307;
    l309 += l308;
    l310 += l309;
    l311 += l310;
    l312 += l311;
    l313 += l312;
    l314 += l313;
    l315 += l314;
    l316 += l315;
    l317 += l316;
    l318 += l317;
    l319 += l318;
    l320 += l319;
    l321 += l320;
    l322 += l321;
    l323 += l322;
    l324 += l323;
    l325 += l324;
    l326 += l325;
    l327 += l326;
    l328 += l327;
    l329 += l328;
    l330 += l329;
    l331 += l330;
    l332 += l331;
    l333 += l332;
    l334 += l333;
    l335 += l334;
    l336 += l335;
    l337 += l336;
    l338 += l337;
    l339 += l338;
    l340 += l339;
    l341 += l340;
    l342 += l341;
    l343 += l342;
    l344 += l343;
    l345 += l344;
    l346 += l345;
    l347 += l346;
    l348 += l347;
    l349 += l348;
    l350 += l349;
    l351 += l350;
    l352 += l351;
    l353 += l352;
    l354 += l353;
    l355 += l354;
    l356 += l355;
    l357 += l356;
    l358 += l357;
    l359 += l358;
    l360 += l359;
    l361 += l360;
    l362 += l361;
    l363 += l362;
    l364 += l363;
    l365 += l364;
    l366 += l365;
    l367 += l366;
    l368 += l367;
    l369 += l368;
    l370 += l369;
    l371 += l370;
    l372 += l371;
    l373 += l372;
    l374 += l373;
    l375 += l374;
    l376 += l375;
    l377 += l376;
    l378 += l377;
    l379 += l378;
    l380 += l379;
    l381 += l380;
    l382 += l381;
    l383 += l382;
    l384 += l383;
    l385 += l384;
    l386 += l385;
    l387 += l386;
    l388 += l387;
    l389 += l388;
    l390 += l389;
    l391 += l390;
    l392 += l391;
    l393 += l392;
    l394 += l393;
    l395 += l394;
    l396 += l395;
    l397 += l396;
    l398 += l397;
    l399 += l398;
    // Create a branch to beat the large method check.
    if (l398 == l399) {
      return l398;
    } else {
      return l399;
    }
  }
}
