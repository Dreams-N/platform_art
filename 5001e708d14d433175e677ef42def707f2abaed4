Revision: 5001e708d14d433175e677ef42def707f2abaed4
Patch-set: 1
File: dex2oat/Android.mk

18:2-18:55
Mon Jul 06 21:24:56 2015 +0000
Author: Nicolas Geoffray <1038443@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: f8f4ce42_5fb94b17
Bytes: 90
Would it make sense to enable PREOPT instead, so boot image and apps are compiled on host?

18:2-18:55
Mon Jul 06 21:28:42 2015 +0000
Author: Evgenii Stepanov <1005967@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: f8f4ce42_5fb94b17
UUID: f356b1ec_9298ba54
Bytes: 72
That would be amazing. Could you point me to the relevant parts of code?

18:2-18:55
Mon Jul 06 21:30:52 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: f356b1ec_9298ba54
UUID: f356b1ec_d2a24286
Bytes: 139
This wouldn't solve the issue for "older" devices. Only shamu and flounder have enough /system space to actually preopt enough of the apps.

18:2-18:55
Mon Jul 06 21:31:22 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: f356b1ec_d2a24286
UUID: 736d61b3_d9cef326
Bytes: 75
(The change would be to force on WITH_DEXPREOPT when SANITIZE_TARGET is on)

18:2-18:55
Mon Jul 06 22:11:19 2015 +0000
Author: Evgenii Stepanov <1005967@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: f356b1ec_d2a24286
UUID: f356b1ec_7212760d
Bytes: 215
Then, I guess, we'd better go ahead with this change.

It would be interesting to sanitize dex2oat, and I'll try to get back to it later, but for now we need to do something about more than 30 minutes startup times.

18:2-18:55
Mon Jul 06 22:16:22 2015 +0000
Author: Andreas Gampe <1041833@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: f356b1ec_7212760d
UUID: 534a1d43_d5a22e86
Bytes: 312
Do we? I don't think you want to push this setup to *anyone* to actually use it (do you?), and then the first-boot overhead is not important anyways.

Otherwise I really want a big graphical warning to the user to not complain about performance. I do *not* want ART to be blamed (which is what people always do).

18:2-18:55
Mon Jul 06 22:25:50 2015 +0000
Author: Evgenii Stepanov <1005967@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 534a1d43_d5a22e86
UUID: 534a1d43_957fc65e
Bytes: 118
This setup could be used to reproduce ASan reports, and it would be good if it could be brought up in reasonable time.

