Revision: 468e324958af1448fd473751bf75079298c6e476
Patch-set: 6
File: compiler/dex/frontend.cc

856
Wed May 21 09:51:27 2014 +0000
Author: Vladimir Marko <1018108@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 0a3da49e_c8be13c3
Bytes: 56
Shouldn't this go to the kCompilerDebugFlags at line 58?

856
Wed May 21 12:16:07 2014 +0000
Author: Bill Buzbee <1001578@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 0a3da49e_c8be13c3
UUID: 3f58ec40_8e8b1f5a
Bytes: 4
Done

File: compiler/dex/quick/arm64/arm64_lir.h

154
Wed May 21 09:45:43 2014 +0000
Author: Matteo Franchin <1037505@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 3f58ec40_2b3c2500
Bytes: 63
rA32_SUSPEND should be rw19, for consistency with rA64_SUSPEND.

154
Wed May 21 12:16:07 2014 +0000
Author: Bill Buzbee <1001578@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 3f58ec40_2b3c2500
UUID: 3f58ec40_6e58eb32
Bytes: 4
Done

157
Wed May 21 09:45:43 2014 +0000
Author: Matteo Franchin <1037505@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: ff281483_8422cf95
Bytes: 408
It should be noted that A64 is the name used - in the ARMv8 architecture specification - to refer to the new 64-bit instruction set, while A32 is used to refer to the old 32-bit Arm instruction set.

If these are temporary names (i.e. meant to disappear soon) then it is fine to commit as is. Otherwise, I would give them a different name (e.g. rA64_xSUSPEND, rA64_wSUSPEND or maybe rxSUSPEND and rwSUSPEND).

157
Wed May 21 12:16:07 2014 +0000
Author: Bill Buzbee <1001578@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: ff281483_8422cf95
UUID: 3f58ec40_2e52f310
Bytes: 92
Yea - let's do a renaming in another CL.  I'd like to lose the capitalized names in general.

File: compiler/dex/quick/arm64/assemble_arm64.cc

669
Wed May 21 09:45:43 2014 +0000
Author: Matteo Franchin <1037505@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: 9f2f188c_e56aba2b
Bytes: 806
Sorry, I should have updated this in the commit where I changed rs_xzr.GetRegNum() to 63.

Considered that reg.GetRegNum() == 31 implies is_zero == false, the condition above can be rewritten as,

  bool is_sp = (reg.GetRegNum() == 31);
  if (want_zero && is_sp) /*error*/

which is correct, but doesn't test the case,

  !want_zero && is_zero

I guess, a possible alternative is

  bool is_either_sp_or_zr = ((reg.GetRegNum() & 0x1f) == 0x1f);
  else if (is_either_sp_or_zr && is_zero != want_zero) /*error*/

I admit all this code - despite being compact - turned out to be easier to write than to read/maintain.

I am happy for you to commit as is: it is more beneficial to have your change committed ASAP, rather than wasting time to get the logic above right (we can do this in later commits, anyway).

669
Wed May 21 12:16:07 2014 +0000
Author: Bill Buzbee <1001578@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 9f2f188c_e56aba2b
UUID: ff281483_c45c57d2
Bytes: 32
OK - rework this in a future CL.

